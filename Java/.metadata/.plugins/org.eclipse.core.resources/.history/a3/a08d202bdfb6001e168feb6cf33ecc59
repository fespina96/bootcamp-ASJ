<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>API EJEMPLO</title>
</head>
<body>
	<table>
		<thead>
			<tr>
				<th>ID</th>
				<th>Nombre</th>
				<th>Apellido</th>
				<th>Nota</th>
			</tr>
		</thead>
		<tbody id="tabla-alumnos-body">
			<tr>
			</tr>
		</tbody>
	</table>
	<button onclick="cargarTabla()">Cargar</button>
	<form>
		<label>ID</label>
		<input id="id"></input>
		<label>Nombre</label>
		<input id="nombre"></input>
		<label>Apellido</label>
		<input id="apellido"></input>
		<label>Nota</label>
		<input id="nota"></input>
		<button onclick="postAlumno()" type="button">Submit</button>
	</form>
	
	<script>
		
		function postAlumno(){
			const idForm = document.getElementById("id");
			const nombreForm = document.getElementById("nombre");
			const apellidoForm = document.getElementById("apellido");
			const notaForm = document.getElementById("nota");
			
			const postBody = JSON.stringify({
				id: idForm.innerText,
				nombre: nombreForm.innerText,
				apellido: apellidoForm.innerText,
				nota: notaForm.innerText
			});
			
			const xmlRequest = new XMLHttpRequest;
			let url = "http://localhost:8080/alumnos/add";
			
			xmlRequest.open('POST',url,true);
			xmlRequest.setRequestHeader('Content-type','application/json');
			
			xmlRequest.onreadystatechange = function() {
				if(xmlRequest.readyState==4 && xmlRequest.status==200){
					alert(xmlRequest.responseText);
				}
			}
			xmlRequest.send(postBody);
			
		}
		
		//CODIGO GER
		        // Hacer una solicitud HTTP para obtener los datos de localhost:8080/alumnos
		        
		function cargarTabla(){
	        let xmlhttp = new XMLHttpRequest();
	        let url = "http://localhost:8080/alumnos";
	
	        xmlhttp.onreadystatechange = function() {
	            if (this.readyState == 4 && this.status == 200) {
	                // Parsear la respuesta JSON
	                let data = JSON.parse(this.responseText);
	
	                // Obtener el cuerpo de la tabla
	                let tablaBody = document.getElementById("tabla-alumnos-body");
					tablaBody.innerHTML = "";
	                // Iterar sobre los datos y agregar filas a la tabla
	                data.forEach(function(alumno) {
	                    let fila = "<tr><td>" + alumno.id + "</td><td>" + alumno.nombre + "</td><td>" + alumno.apellido + "</td><td>" + alumno.nota + "</td></tr>";
	                    tablaBody.innerHTML += fila;
	                });
	            }
	        };
	
	        xmlhttp.open("GET", url, true);
	        xmlhttp.send();
		}
		
		cargarTabla();
	</script>
</body>
</html>